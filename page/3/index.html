<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.0.2">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"blog.leiyanhui.com","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="小类随手记">
<meta property="og:url" content="http://blog.leiyanhui.com/page/3/index.html">
<meta property="og:site_name" content="小类随手记">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="joyanhui@qq.com">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://blog.leiyanhui.com/page/3/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>小类随手记</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">小类随手记</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">Just so so ...</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://blog.leiyanhui.com/2020/08/22/typecho/ubuntu-clash.html/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="joyanhui@qq.com">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小类随手记">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/08/22/typecho/ubuntu-clash.html/" class="post-title-link" itemprop="url">ubuntu下安装某c工具用来v上网</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2020-08-22 01:49:44 / 修改时间：10:45:07" itemprop="dateCreated datePublished" datetime="2020-08-22T01:49:44+08:00">2020-08-22</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>1、创建一个目录</p>
<p>cd ~<br>下载 <a target="_blank" rel="noopener" href="https://github.com/Dreamacro/clash/releases">https://github.com/Dreamacro/clash/releases</a><br>解压<br>右键点击 clash-linux，选择属性，权限处勾选允许以程序执行<br>重命名为 clash<br>2、下载某配置文件<br>wget -O config.yml<br><a target="_blank" rel="noopener" href="https://v2.xxx.site/link/xxx?clash=1&amp;log-level=info">https://v2.xxx.site/link/xxx?clash=1&amp;log-level=info</a><br>移动到<br>/.config/clash$</p>
<p>3、运行<br>~/clash</p>
<p>4、配置 直接打开 <a target="_blank" rel="noopener" href="http://clash.razord.top/#/proxies">http://clash.razord.top/#/proxies</a> 即可查看gui配置</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://blog.leiyanhui.com/2020/08/22/typecho/typecho_AllsitePasswd_Plugin.html/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="joyanhui@qq.com">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小类随手记">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/08/22/typecho/typecho_AllsitePasswd_Plugin.html/" class="post-title-link" itemprop="url">typecho全站加密插件/全站内容加密/文章加密/单页加密/首页加密</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2020-08-22 01:49:44 / 修改时间：10:37:48" itemprop="dateCreated datePublished" datetime="2020-08-22T01:49:44+08:00">2020-08-22</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>适合日记站或者内部通知站，输入密码后方可查看网站内容，兼容v1.1<br>(17.10.30)</p>
<p>wp下有very-simple-password可以用，typecho下一直没找到合适的，只好自己动手。<br>;第一次写typecho的插件，花了几个小时看文档。功能如图</p>
<p>只有一个文件 Plugin.php<br>上传到/usr/plugins/AllsitePasswd/目录，然后在后台启用即可</p>
<p>密码提示语言 提示图片均可以修改，也可以<br>在main_fun函数内编辑前台显示样式。</p>
<p>值得注意的是<br>1、默认密码：123456，请修改强壮一些<br>2、因为入口是index.php，后台操作可能会被拦截，建议前台登陆后再进行后台操作<br>3、如忘记密码，建议直接删除/usr/plugins/AllsitePasswd/目录<br>后进入后台删除插件，然后重新安装即可</p>
<p>下载地址：<a target="_blank" rel="noopener" href="https://u2397981.ctfile.com/fs/2397981-314921190">https://u2397981.ctfile.com/fs/2397981-314921190</a></p>
<p><img src="http://leiyanhui.com/_Resource/uploads/2018/10/1307219110.jpg" alt="houtai.jpg" title="houtai.jpg"><br><img src="http://leiyanhui.com/_Resource/uploads/2018/10/4080791910.jpg" alt="qiantai1.jpg" title="qiantai1.jpg"></p>
<p><img src="http://leiyanhui.com/_Resource/uploads/2018/10/1642301463.jpg" alt="qiantai2.jpg" title="qiantai2.jpg"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://blog.leiyanhui.com/2020/08/22/typecho/typecho-url.html/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="joyanhui@qq.com">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小类随手记">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/08/22/typecho/typecho-url.html/" class="post-title-link" itemprop="url">typecho对sqlite的支持、灵活的目录结构和简洁的设计让人爱不释手</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2020-08-22 01:49:44 / 修改时间：11:07:02" itemprop="dateCreated datePublished" datetime="2020-08-22T01:49:44+08:00">2020-08-22</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>typecho支持sqlite<br>这个很大程度上决定了在轻量应用的时她成为我的首选。例如本站..例如一个简单的产品展示内容展示站。</p>
<p>目录结构：打开config.inc.php后发现，所有的文件夹名可以修改！<br>我可以把后台改为 leiyanhui.com/hou-tai/<br>var 改为 phpfile<br>usr里面是保存模板插件和sqlite数据的，我可以改为Resource</p>
<p>甚至，我可以复用index.phpgai&#39;diaoconfig.inc.php。</p>
<p>更甚至</p>
<pre><code>if($_SERVER[&quot;HTTP_HOST&quot;]==&quot;A域名.com&quot; || $_SERVER[&quot;HTTP_HOST&quot;]==&quot;www.A域名.com&quot;)(花括号)</code></pre>
<p>$db = new Typecho_Db(&#39;Mysql&#39;, &#39;A_&#39;);<br>(花括号)<br>else if($_SERVER[&quot;HTTP_HOST&quot;]==&quot;B域名.com&quot; ||<br>$_SERVER[&quot;HTTP_HOST&quot;]==&quot;<a target="_blank" rel="noopener" href="http://www.b域名.com/&quot;)(%E8%8A%B1%E6%8B%AC%E5%8F%B7)/">www.B域名.com\&quot;)(花括号)\</a><br>$db = new Typecho_Db(&#39;Mysql&#39;, &#39;B_&#39;);<br>(花括号)<br>$db-&gt;addServer(array (<br>&#39;host&#39; =&gt; &#39;localhost&#39;,<br>&#39;user&#39; =&gt; &#39;数据库用户名&#39;,<br>&#39;password&#39; =&gt; &#39;数据库密码&#39;,<br>&#39;charset&#39; =&gt; &#39;utf8&#39;,<br>&#39;port&#39; =&gt; &#39;3306&#39;,<br>&#39;database&#39; =&gt; &#39;数据库名&#39;,<br>), Typecho_Db::READ | Typecho_Db::WRITE);<br>Typecho_Db::set($db);</p>
<p>同样如果sqlite数据库也很简单了</p>
<hr>
<p>不过后台编辑器真的是简陋，官网的几个编辑器插件多少还有一点问题，直接拿来就用还是勉强</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://blog.leiyanhui.com/2020/08/22/typecho/site-to-typecho.html/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="joyanhui@qq.com">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小类随手记">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/08/22/typecho/site-to-typecho.html/" class="post-title-link" itemprop="url">typecho全站加密插件/全站内容加密/文章加密/单页加密/首页加密</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2020-08-22 01:49:44 / 修改时间：10:38:23" itemprop="dateCreated datePublished" datetime="2020-08-22T01:49:44+08:00">2020-08-22</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>2020年重新迁移到 hexo<br>wp的强大。。还有通用性。<br>确实带来很多方便，但是臃肿带来的困扰，还是让我决定舍弃之..<br>一个小小的随手记网站都可以卡成一坨屎，实在是震惊。</p>
<hr>
<p>本以为wp站群到typecho迁移会又一些麻烦，没想到一切很顺利。<br>用了typecho的官网插件 顺利把文字迁移过来。url有一些冲突不过勉强还可以用<br>未影响搜索引擎收录。</p>
<p>不过丢失了所有的浏览次数的记录，全部归0了 ...</p>
<p>顺便付费买了一个模板 ，看上去还可以</p>
<p>typecho 是国人写的一个轻量级博客应用</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://blog.leiyanhui.com/2020/08/22/typecho/right-menu-notpad2.html/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="joyanhui@qq.com">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小类随手记">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/08/22/typecho/right-menu-notpad2.html/" class="post-title-link" itemprop="url">右键菜单新增notpad2/Notepad++打开，带图标的，以及删除菜单</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2020-08-22 01:49:44 / 修改时间：10:39:07" itemprop="dateCreated datePublished" datetime="2020-08-22T01:49:44+08:00">2020-08-22</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>Windows Registry Editor Version 5.00<br>    [HKEY_CLASSES_ROOT<em>shellnotepad2]<br>    @=”用&amp;notepad2打开”<br>    “Icon”=”D:\GreenSoft\Office-Design\notepad2\notepad2.exe”<br>    [HKEY_CLASSES_ROOT</em>shellnotepad2Command]<br>    @=”D:\GreenSoft\Office-Design\notepad2\notepad2.exe “%1””</p>
<p>&lt;!--more--&gt;</p>
<pre><code>Windows Registry Editor Version 5.00
[HKEY_CLASSES_ROOT*shellNotePad++]
@=&quot;用&amp;Notepad++打开&quot;
&quot;Icon&quot;=&quot;D:\GreenSoft\Office-Design\NotePad++\NotePad++.exe&quot;
[HKEY_CLASSES_ROOT*shellNotePad++Command]
@=&quot;D:\GreenSoft\Office-Design\NotePad++\NotePad++.exe &quot;%1&quot;&quot;</code></pre>
<p>删除</p>
<pre><code>Windows Registry Editor Version 5.00
[-HKEY_CLASSES_ROOT*shellNotePad2]

Windows Registry Editor Version 5.00
[-HKEY_CLASSES_ROOT*shellNotePad++]</code></pre>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://blog.leiyanhui.com/2020/08/22/typecho/reset-centos-vps.html/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="joyanhui@qq.com">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小类随手记">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/08/22/typecho/reset-centos-vps.html/" class="post-title-link" itemprop="url">预设vps环境</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2020-08-22 01:49:44 / 修改时间：10:39:23" itemprop="dateCreated datePublished" datetime="2020-08-22T01:49:44+08:00">2020-08-22</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>有一些vps的模板 竟然带一堆桌面文件。。清理</p>
<pre><code> getconf LONG_BIT</code></pre>
<p>确定centos</p>
<pre><code>yum -y remove Deployment_Guide-en-US cups-libs cups bluez-libs desktop-file-utils ppp rp-pppoe wireless-tools irda-utils nfs-utils nfs-utils-lib rdate fetchmail eject ksh mkbootdisk mtools syslinux tcsh startup-notification talk apmd rmt dump setserial portmap yp-tools ypbind  telnet rsh rcp</code></pre>
<p>删除不常用的软件</p>
<pre><code>vi /etc/inittab</code></pre>
<p>把id:5:initdefault:改成 id:3:initdefault:</p>
<p>禁止桌面相关软件启动</p>
<pre><code>reboot</code></pre>
<p>重启</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://blog.leiyanhui.com/2020/08/22/typecho/php-sqlite.html/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="joyanhui@qq.com">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小类随手记">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/08/22/typecho/php-sqlite.html/" class="post-title-link" itemprop="url">一个php操作sqlite的相关代码</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2020-08-22 01:49:44 / 修改时间：11:07:02" itemprop="dateCreated datePublished" datetime="2020-08-22T01:49:44+08:00">2020-08-22</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>比较好用的sqlite管理软件<br>SQLiteStudio。可以创建sqlite，但是不知道为什么多个sql语句一起执行的时候，有时候会有错误。&lt;!--more--&gt;</p>
<p>1、设置sqlite文件</p>
<pre><code>$sqlitepath=&quot;sqlite-20170210-101.db&quot;;</code></pre>
<p>2、插入记录</p>
<pre><code>$db = NULL;$db=new PDO(&#39;sqlite:&#39;.$sqlitepath);
$sql=&quot;INSERT INTO &#39;gustbook&#39; (&#39;card_id&#39;,&#39;order_id&#39;,&#39;title&#39;,&#39;content&#39;,&#39;admin_id&#39;,&#39;addtime&#39;) VALUES ( &quot;.$card_id.&quot;,&quot;.$order_id.&quot;,&#39;&quot;.$title.&quot;&#39;,&#39;&quot;.$content.&quot;&#39;,&#39;&quot;.$admin_id.&quot;&#39;,&quot;.time(). &quot;)&quot;;
$result=$db-&gt;exec($sql);
$result=NULL;</code></pre>
<p>3、删除记录&lt;pre&gt;<br>$db=NULL;$db=new PDO(&#39;sqlite:&#39;.$sqlitepath);<br>$sql=&quot;DELETE FROM &#39;gustbook&#39; where id = &quot;.$id.&quot; and<br>card_id=&quot;.$card_id;<br>$result=$db-&gt;exec($sql);<br>$result=NULL;<br>&lt;/pre&gt;<br>4、修改记录&lt;pre&gt;<br>$db=NULL;$db=new PDO(&#39;sqlite:&#39;.$sqlitepath);<br>$result=$db-&gt;exec(&quot;UPDATE <code>gustbook</code> SET<br><code>re</code>=&#39;$re&#39;,<code>exptime</code>=&#39;&quot;.time().&quot;&#39; where <code>id</code> =$id&quot;);<br>$result=NULL;<br>&lt;/pre&gt;<br>5、查询单条记录&lt;pre&gt;<br>$db=new PDO(&#39;sqlite:&#39;.$sqlitepath);<br>$result=$db-&gt;query(&quot;SELECT * FROM admin where<br>username=&#39;&quot;.$username.&quot;&#39; and passwd=&#39;&quot;.$passwd.&quot;&#39;&quot;);<br>$row = $result-&gt;fetch();<br>if ($row)(花括号)</p>
<pre><code>$_SESSION[&#39;admin_id&#39;]=$row[&#39;id&#39;];
$_SESSION[&#39;admin_username&#39;]=$row[&#39;username&#39;];
msg(&#39;登陆成功&#39;,&#39;OK&#39;,&#39;&lt;p&gt;登陆成功&lt;/p&gt;&lt;p&gt;稍后进去管理后台&lt;/p&gt;&#39;,&#39;admin.php?ac=list&#39;,&#39;进入后台面板&#39;,&#39;6&#39;);</code></pre>
<p>(花括号)<br>else(花括号)</p>
<pre><code>msg(&#39;登陆失败&#39;,&#39;提示&#39;,&#39;&lt;p&gt;请检查您的输入有错误&lt;/p&gt;&lt;p&gt;用户名密码错误&lt;/p&gt;&#39;,&#39;admin.php?ac=login&#39;,&#39;重新登陆&#39;,&#39;6&#39;);</code></pre>
<p>(花括号)<br>$result=NULL;<br>&lt;/pre&gt;<br>6、查询多个记录，并循环&lt;pre&gt;<br>$db=NULL;$db=new PDO(&#39;sqlite:&#39;.$sqlitepath);<br>$result=$db-&gt;query(&quot;SELECT * FROM &#39;gustbook&#39; where card_id =<br>&quot;.$_SESSION[&#39;card_id&#39;].&quot; order by id desc&quot;);<br>if ($result)(花括号)<br>while($row = $result-&gt;fetch())(花括号)</p>
<pre><code>echo $row[&#39;title&#39;];</code></pre>
<p>(花括号)<br>(花括号)<br>$result=NULL;<br>&lt;/pre&gt;</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://blog.leiyanhui.com/2020/08/22/typecho/php-reverse-proxy.html/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="joyanhui@qq.com">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小类随手记">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/08/22/typecho/php-reverse-proxy.html/" class="post-title-link" itemprop="url">一个php反向代理程序（php-reverse-proxy）的必要性和需求</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2020-08-22 01:49:44 / 修改时间：11:07:02" itemprop="dateCreated datePublished" datetime="2020-08-22T01:49:44+08:00">2020-08-22</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>反向代理（Reverse Proxy）<br>就是接受用户的请求，然后发送给后端服务器，然后再把后端服务器的处理内容反馈给用户。目前用的毕竟多的是nginx吧，简单高效。但是多时候，我们并没有独立服务器用，可能是一个小小的php空间。<br>它能做的：用一个虚拟主机，完成代理访问。镜像一个网站。ip被封锁的时候，低成本应急开通访问地址。那么它应该有的功能。<br>之前用过7ghost 很久不更新了哦。各种不兼容和bug。<br>为为什么想要做这个？<br><br>首先是因为没有合适的程序用<br>前然后。多年前做站，自己辛苦写的代码和整理的数据。放在虚拟主机或者vps上，被人直接copy掉了。所以反向代理是最能解决这个问题的。<br>还还有就是虚拟的性能真的堪忧，简单的应用可以应付，复杂的数据使用，直接崩了，轻则打不开，重了被商家封掉。<br>这个程序也会被人拿走，数据也会，但是只是公开的静态页面而已。你网站被人wget<br>-m一下，不是也会被镜像掉。这个程序不是解决这个问题而存在的。不要本末倒置。<br>你可以用它镜像别人的站的公开内容。也可以用它来保护自己的站。随便吧。<br>如果你有外网ip，或者可以做内网穿透，没有80端口没关系，这都可以帮你反向代理出去。</p>
<p>基于这个需求，催生了这个小项目。并且会开源共享出来。</p>
<p>1/ 尽量避免依赖固定函数，应该依次 curl /file_get_contents<br>/fopen（allow_url_fopen）/Fsockopen<br>2/ 多域名模式 多站点模式 域名判断 和 l_siteid<br>2.1/ 基于域名可以访问，为了简单期间 附加域名应该重定向到主域名<br>2.2/ 基于l_siteid 可以访问<br>2.3/ 分组管理，一个主站下 可关联多个域名规则（外部url）<br>3/ 技术数据库和文件的缓存方式<br>3.1 基于文件的方式会导致大量碎片文件，好像得不偿失，sqlite分库</p>
<pre><code>   3.1.1 sqlite分库 采用索引 加 分库，索引里面标注库名和id （md5的第一位0或者N位  /index/n-1/n-2/b.sqite）
   3.1.2 索引库 用md5分,默认不分 index.sqlite，1位 index/a.sqlite 2位 index/a/b.sqlite
   3.1.3 内容库 插入入之前先查询数据库大小和当前内容，限定单个数据的大小
   3.1.3 更新缓存 可能会导致之前的数据库变大，所以更新缓存的时候 要删除之前的记录。</code></pre>
<p>3.2 基于mysql（没有百万级别的数据，意义不大，暂时搁置）<br>3.3 基于oss/COS/upyun等储存（后期 可以试试oss和cos）<br>4/ 缓存的刷新机制<br>4.1 手动更新： url末尾加 &amp;lyh_update=key<br>自动更新。key是更新密钥，默认是1或者yes<br>4.2 自动更新机制：</p>
<pre><code>    4.2.1 不同后缀更新时间不同：img css js 类，就是url规则设定，设定过期时间
    4.2.2 设置url规则的更新时间，例如url包含 login、update、post、save等单独设置更新时间&lt;rar/flv之类的不索引&gt;
    4.2.3 单个文件大于多少字节的不索引</code></pre>
<p>5/ 限制缓存条数<br>5.1 按照访问次数排序 次数多的缓存，排名之外的，删除</p>
<p>初始版本应该实现的功能<br>1、pdo.sqlite数据库<br>2、多域名 树形<br>3、兼容阿里云的弹性web PHP 5.2.17/ fsockopen<br>4、单一库功能，或者分库<br>目录结构<br>index.php<br>_core &lt;admin|system site.sqlite&gt;<br>_cache/(花括号)siteid(花括号)/&lt;index|content&gt;.&lt;num&gt;.sqlite</p>
<p>数据库结构<br>----system 系统管理---<br>admin user（后台用户）<br>admin psw（后台密码）<br>sqlite_name单个sqlite文件大小<br>---site站点管理----<br>siteid(站点id)<br>name（站点名称/后台用）<br>domain（绑定域名）<br>url（代理地址）<br>replace_rule（html替换规则）<br>url_cache_rule(基于地址的缓存规则)<br>filesize_limt(过大的文件不缓存)<br>is_debug(调试模式)<br>----urlindex 地址索引管理----<br>url_id<br>url_hase（urlmd5码）<br>updatetime（保存时间戳）<br>count（pv次数）<br>----content----<br>url_id<br>url_content</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://blog.leiyanhui.com/2020/08/22/typecho/php-pdo-sqlite-class.html/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="joyanhui@qq.com">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小类随手记">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/08/22/typecho/php-pdo-sqlite-class.html/" class="post-title-link" itemprop="url">一个php操作sqlite的类</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2020-08-22 01:49:44 / 修改时间：11:03:01" itemprop="dateCreated datePublished" datetime="2020-08-22T01:49:44+08:00">2020-08-22</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>已经删除，重写了一个 以后有时间放出来</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://blog.leiyanhui.com/2020/08/22/typecho/onpage-html-css-404.html/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="joyanhui@qq.com">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小类随手记">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/08/22/typecho/onpage-html-css-404.html/" class="post-title-link" itemprop="url">单文件纯html css写的一个404/502页面</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2020-08-22 01:49:44 / 修改时间：11:07:02" itemprop="dateCreated datePublished" datetime="2020-08-22T01:49:44+08:00">2020-08-22</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>&lt;!DOCTYPE html&gt;<br>&lt;html&gt;<br>&lt;head&gt;<br>&lt;meta charset=utf-8 /&gt;<br>&lt;title&gt;index&lt;/title&gt;<br>&lt;style&gt;<br>@charset &quot;utf-8&quot;;<br>.button (花括号)display: inline-block;zoom: 1; *display:<br>inline;vertical-align: baseline;margin: 0 2px;outline: none;cursor:<br>pointer;text-align: center;text-decoration: none;font: 14px/100% Arial,<br>Helvetica, sans-serif;padding:0.25em 0.6em 0.3em;text-shadow: 0 1px 1px<br>rgba(0,0,0,.3);-webkit-border-radius: .5em; -moz-border-radius:<br>.5em;border-radius: .5em;-webkit-box-shadow: 0 1px 2px<br>rgba(0,0,0,.2);-moz-box-shadow: 0 1px 2px rgba(0,0,0,.2);box-shadow: 0<br>1px 2px rgba(0,0,0,.2);<br>(花括号)<br>.red (花括号)color: #faddde;border: solid 1px #980c10;background:<br>#d81b21;background: -webkit-gradient(linear, left top, left bottom,<br>from(#ed1c24), to(#A51715));background: -moz-linear-gradient(top,<br>#ed1c24, #A51715);filter:<br>progid:DXImageTransform.Microsoft.gradient(startColorstr=&#39;#ed1c24&#39;,<br>endColorstr=&#39;#aa1317&#39;); font-size:14px!important;<br>color:#fff!important;(花括号)<br>.red:hover (花括号) background: #b61318; background: -webkit-gradient(linear,<br>left top, left bottom, from(#c9151b), to(#a11115)); background:<br>-moz-linear-gradient(top, #c9151b, #a11115); filter:<br>progid:DXImageTransform.Microsoft.gradient(startColorstr=&#39;#c9151b&#39;,<br>endColorstr=&#39;#a11115&#39;); color:#fff;(花括号)<br>.red:active (花括号)color: #de898c;background: -webkit-gradient(linear, left<br>top, left bottom, from(#aa1317), to(#ed1c24));background:<br>-moz-linear-gradient(top, #aa1317, #ed1c24);filter:<br>progid:DXImageTransform.Microsoft.gradient(startColorstr=&#39;#aa1317&#39;,<br>endColorstr=&#39;#ed1c24&#39;);(花括号)<br>.keTitle(花括号) height: 60px; line-height: 60px; font-size: 28px; font-family:<br>&#39;微软雅黑&#39;; color: #444; text-align: center; background:<br>url(../images/bodyBg1.gif) repeat-x left bottom; font-weight: normal;<br>position: fixed; width: 100%; left: 0; top: 0; z-index: 999; padding:<br>0px 0px 8px; opacity:0.8; (花括号)<br>.keBottom(花括号) color: #444; height: 60px; text-align: center; background:<br>url(../images/bodyBg2.gif) repeat-x left top; position: fixed; width:<br>100%; left: 0; bottom: 0; z-index: 999; font: 18px/60px &quot;微软雅黑&quot;;<br>padding: 3px 0px 5px;opacity:0.8; (花括号)<br>.keBottom a,.keBottom a:hover(花括号)color:#444;(花括号)<br>body (花括号)<br>background-color: #ECECEC;<br>font-family: &#39;Open Sans&#39;, sans-serif;<br>font-size: 14px;<br>color: #3c3c3c;<br>(花括号)</p>
<p>.demo p:first-child (花括号)<br>text-align: center;<br>font-family: cursive;<br>font-size: 150px;<br>font-weight: bold;<br>line-height: 100px;<br>letter-spacing: 5px;<br>color: #fff;<br>(花括号)</p>
<p>.demo p:first-child span (花括号)<br>cursor: pointer;<br>text-shadow: 0px 0px 2px #686868,</p>
<pre><code>0px 1px 1px #ddd,
0px 2px 1px #d6d6d6,
0px 3px 1px #ccc,
0px 4px 1px #c5c5c5,
0px 5px 1px #c1c1c1,
0px 6px 1px #bbb,
0px 7px 1px #777,
0px 8px 3px rgba(100, 100, 100, 0.4),
0px 9px 5px rgba(100, 100, 100, 0.1),
0px 10px 7px rgba(100, 100, 100, 0.15),
0px 11px 9px rgba(100, 100, 100, 0.2),
0px 12px 11px rgba(100, 100, 100, 0.25),
0px 13px 15px rgba(100, 100, 100, 0.3);</code></pre>
<p>-webkit-transition: all .1s linear;<br>transition: all .1s linear;<br>(花括号)</p>
<p>.demo p:first-child span:hover (花括号)<br>text-shadow: 0px 0px 2px #686868,</p>
<pre><code>0px 1px 1px #fff,
0px 2px 1px #fff,
0px 3px 1px #fff,
0px 4px 1px #fff,
0px 5px 1px #fff,
0px 6px 1px #fff,
0px 7px 1px #777,
0px 8px 3px #fff,
0px 9px 5px #fff,
0px 10px 7px #fff,
0px 11px 9px #fff,
0px 12px 11px #fff,
0px 13px 15px #fff;</code></pre>
<p>-webkit-transition: all .1s linear;<br>transition: all .1s linear;<br>(花括号)</p>
<p>.demo p:not(:first-child) (花括号)<br>text-align: center;<br>color: #666;<br>font-family: cursive;<br>font-size: 20px;<br>text-shadow: 0 1px 0 #fff;<br>letter-spacing: 1px;<br>line-height: 2em;<br>margin-top: -50px;<br>(花括号)</p>
<p>&lt;/style&gt;<br>&lt;/head&gt;<br>&lt;body&gt;<br>&lt;h1 class=&quot;keTitle&quot;&gt;访问的站点不存在&lt;/h1&gt;<br>&lt;!--效果html开始--&gt;<br>&lt;div class=&quot;demo&quot;&gt;</p>
<pre><code>&lt;p align=&quot;center&quot;&gt;&lt;span&gt;4&lt;/span&gt;&lt;span&gt;0&lt;/span&gt;&lt;span&gt;4&lt;/span&gt;&lt;/p&gt;
&lt;p align=&quot;center&quot;&gt;该页面不存在(´･ω･`)&lt;/p&gt;</code></pre>
<p>&lt;/div&gt;<br>&lt;!--效果html结束--&gt;<br>&lt;div class=&quot;keBottom&quot;&gt; 基于Vultr，by<br><a target="_blank" rel="noopener" href="http://leiyanhui.com/">leiyanhui.com</a>(花括号).keUrl(花括号)<br>&lt;/div&gt;<br>&lt;/body&gt;<br>&lt;/html&gt;</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/2/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/8/">8</a><a class="extend next" rel="next" href="/page/4/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">joyanhui@qq.com</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">75</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">joyanhui@qq.com</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
