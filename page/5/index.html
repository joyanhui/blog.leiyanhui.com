<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.0.2">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"blog.leiyanhui.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="小类随手记">
<meta property="og:url" content="http://blog.leiyanhui.com/page/5/index.html">
<meta property="og:site_name" content="小类随手记">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="joyanhui@qq.com">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://blog.leiyanhui.com/page/5/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>小类随手记</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">小类随手记</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">Just so so ...</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://blog.leiyanhui.com/2020/08/22/typecho/php-pdo-sqlite-class.html/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="joyanhui@qq.com">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小类随手记">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/08/22/typecho/php-pdo-sqlite-class.html/" class="post-title-link" itemprop="url">一个php操作sqlite的类</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2020-08-22 01:49:44 / 修改时间：11:03:01" itemprop="dateCreated datePublished" datetime="2020-08-22T01:49:44+08:00">2020-08-22</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>已经删除，重写了一个 以后有时间放出来</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://blog.leiyanhui.com/2020/08/22/typecho/onpage-html-css-404.html/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="joyanhui@qq.com">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小类随手记">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/08/22/typecho/onpage-html-css-404.html/" class="post-title-link" itemprop="url">单文件纯html css写的一个404/502页面</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2020-08-22 01:49:44 / 修改时间：11:07:02" itemprop="dateCreated datePublished" datetime="2020-08-22T01:49:44+08:00">2020-08-22</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>&lt;!DOCTYPE html&gt;<br>&lt;html&gt;<br>&lt;head&gt;<br>&lt;meta charset=utf-8 /&gt;<br>&lt;title&gt;index&lt;/title&gt;<br>&lt;style&gt;<br>@charset &quot;utf-8&quot;;<br>.button (花括号)display: inline-block;zoom: 1; *display:<br>inline;vertical-align: baseline;margin: 0 2px;outline: none;cursor:<br>pointer;text-align: center;text-decoration: none;font: 14px/100% Arial,<br>Helvetica, sans-serif;padding:0.25em 0.6em 0.3em;text-shadow: 0 1px 1px<br>rgba(0,0,0,.3);-webkit-border-radius: .5em; -moz-border-radius:<br>.5em;border-radius: .5em;-webkit-box-shadow: 0 1px 2px<br>rgba(0,0,0,.2);-moz-box-shadow: 0 1px 2px rgba(0,0,0,.2);box-shadow: 0<br>1px 2px rgba(0,0,0,.2);<br>(花括号)<br>.red (花括号)color: #faddde;border: solid 1px #980c10;background:<br>#d81b21;background: -webkit-gradient(linear, left top, left bottom,<br>from(#ed1c24), to(#A51715));background: -moz-linear-gradient(top,<br>#ed1c24, #A51715);filter:<br>progid:DXImageTransform.Microsoft.gradient(startColorstr=&#39;#ed1c24&#39;,<br>endColorstr=&#39;#aa1317&#39;); font-size:14px!important;<br>color:#fff!important;(花括号)<br>.red:hover (花括号) background: #b61318; background: -webkit-gradient(linear,<br>left top, left bottom, from(#c9151b), to(#a11115)); background:<br>-moz-linear-gradient(top, #c9151b, #a11115); filter:<br>progid:DXImageTransform.Microsoft.gradient(startColorstr=&#39;#c9151b&#39;,<br>endColorstr=&#39;#a11115&#39;); color:#fff;(花括号)<br>.red:active (花括号)color: #de898c;background: -webkit-gradient(linear, left<br>top, left bottom, from(#aa1317), to(#ed1c24));background:<br>-moz-linear-gradient(top, #aa1317, #ed1c24);filter:<br>progid:DXImageTransform.Microsoft.gradient(startColorstr=&#39;#aa1317&#39;,<br>endColorstr=&#39;#ed1c24&#39;);(花括号)<br>.keTitle(花括号) height: 60px; line-height: 60px; font-size: 28px; font-family:<br>&#39;微软雅黑&#39;; color: #444; text-align: center; background:<br>url(../images/bodyBg1.gif) repeat-x left bottom; font-weight: normal;<br>position: fixed; width: 100%; left: 0; top: 0; z-index: 999; padding:<br>0px 0px 8px; opacity:0.8; (花括号)<br>.keBottom(花括号) color: #444; height: 60px; text-align: center; background:<br>url(../images/bodyBg2.gif) repeat-x left top; position: fixed; width:<br>100%; left: 0; bottom: 0; z-index: 999; font: 18px/60px &quot;微软雅黑&quot;;<br>padding: 3px 0px 5px;opacity:0.8; (花括号)<br>.keBottom a,.keBottom a:hover(花括号)color:#444;(花括号)<br>body (花括号)<br>background-color: #ECECEC;<br>font-family: &#39;Open Sans&#39;, sans-serif;<br>font-size: 14px;<br>color: #3c3c3c;<br>(花括号)</p>
<p>.demo p:first-child (花括号)<br>text-align: center;<br>font-family: cursive;<br>font-size: 150px;<br>font-weight: bold;<br>line-height: 100px;<br>letter-spacing: 5px;<br>color: #fff;<br>(花括号)</p>
<p>.demo p:first-child span (花括号)<br>cursor: pointer;<br>text-shadow: 0px 0px 2px #686868,</p>
<pre><code>0px 1px 1px #ddd,
0px 2px 1px #d6d6d6,
0px 3px 1px #ccc,
0px 4px 1px #c5c5c5,
0px 5px 1px #c1c1c1,
0px 6px 1px #bbb,
0px 7px 1px #777,
0px 8px 3px rgba(100, 100, 100, 0.4),
0px 9px 5px rgba(100, 100, 100, 0.1),
0px 10px 7px rgba(100, 100, 100, 0.15),
0px 11px 9px rgba(100, 100, 100, 0.2),
0px 12px 11px rgba(100, 100, 100, 0.25),
0px 13px 15px rgba(100, 100, 100, 0.3);</code></pre>
<p>-webkit-transition: all .1s linear;<br>transition: all .1s linear;<br>(花括号)</p>
<p>.demo p:first-child span:hover (花括号)<br>text-shadow: 0px 0px 2px #686868,</p>
<pre><code>0px 1px 1px #fff,
0px 2px 1px #fff,
0px 3px 1px #fff,
0px 4px 1px #fff,
0px 5px 1px #fff,
0px 6px 1px #fff,
0px 7px 1px #777,
0px 8px 3px #fff,
0px 9px 5px #fff,
0px 10px 7px #fff,
0px 11px 9px #fff,
0px 12px 11px #fff,
0px 13px 15px #fff;</code></pre>
<p>-webkit-transition: all .1s linear;<br>transition: all .1s linear;<br>(花括号)</p>
<p>.demo p:not(:first-child) (花括号)<br>text-align: center;<br>color: #666;<br>font-family: cursive;<br>font-size: 20px;<br>text-shadow: 0 1px 0 #fff;<br>letter-spacing: 1px;<br>line-height: 2em;<br>margin-top: -50px;<br>(花括号)</p>
<p>&lt;/style&gt;<br>&lt;/head&gt;<br>&lt;body&gt;<br>&lt;h1 class=&quot;keTitle&quot;&gt;访问的站点不存在&lt;/h1&gt;<br>&lt;!--效果html开始--&gt;<br>&lt;div class=&quot;demo&quot;&gt;</p>
<pre><code>&lt;p align=&quot;center&quot;&gt;&lt;span&gt;4&lt;/span&gt;&lt;span&gt;0&lt;/span&gt;&lt;span&gt;4&lt;/span&gt;&lt;/p&gt;
&lt;p align=&quot;center&quot;&gt;该页面不存在(´･ω･`)&lt;/p&gt;</code></pre>
<p>&lt;/div&gt;<br>&lt;!--效果html结束--&gt;<br>&lt;div class=&quot;keBottom&quot;&gt; 基于Vultr，by<br><a target="_blank" rel="noopener" href="http://leiyanhui.com/">leiyanhui.com</a>(花括号).keUrl(花括号)<br>&lt;/div&gt;<br>&lt;/body&gt;<br>&lt;/html&gt;</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://blog.leiyanhui.com/2020/08/22/typecho/online-update-hosts.html/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="joyanhui@qq.com">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小类随手记">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/08/22/typecho/online-update-hosts.html/" class="post-title-link" itemprop="url">在线hosts文件,Mac和win下通用</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2020-08-22 01:49:44 / 修改时间：11:07:02" itemprop="dateCreated datePublished" datetime="2020-08-22T01:49:44+08:00">2020-08-22</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>Mac下要修改/etc/hosts权限</p>
<pre><code>下载地址 https://github.com/oldj/SwitchHosts

点击桌面上方的“前往”-&gt;“前往文件夹”（或者快捷键 Shift+Command+G）  输入 /private 按回车，进入 etc 文件夹下面，修改名为 hosts 文件的权限， everyone（或者当前登录用户） 的“读与写”，修改完成之后，你就可以直接在 hosts 文件上点右键，通过“文本编辑”打开并编辑该文件了。或者用SwitchHosts修改</code></pre>
<p>添加自定义hosts配置，或者用在线hosts列表<br><img src="http://leiyanhui.com/_Resource/uploads/FormWordpress/2017/02/SwitchHosts-.png">(花括号).alignnone<br>.size-full .wp-image-117 width=”1187” height=”755”(花括号)<br>也可以不下载自己修改hosts文件</p>
<p>网友提供的一个经常更新的hosts列表</p>
<pre><code>https://github.com/racaljk/hosts
在线hosts：https://raw.githubusercontent.com/racaljk/hosts/master/hosts

https://coding.net/u/scaffrey/p/hosts/git
在线hosts：https://coding.net/u/scaffrey/p/hosts/git/raw/master/hosts</code></pre>
<p>另外一个经常更新的hosts不过博主把文件放到了百度网盘(已经关闭删除不再更新)，不能直接在SwitchHosts调用远程hosts</p>
<pre><code>http://htcui点com/4938.html</code></pre>
<p>更新后，https可以访问大多数网站。 现在已经不行了，还是科学 靠谱</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://blog.leiyanhui.com/2020/08/22/typecho/onekeybakfile.html/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="joyanhui@qq.com">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小类随手记">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/08/22/typecho/onekeybakfile.html/" class="post-title-link" itemprop="url">随手写了一个批处理程序，一键备份指定目录文件</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2020-08-22 01:49:44 / 修改时间：10:41:58" itemprop="dateCreated datePublished" datetime="2020-08-22T01:49:44+08:00">2020-08-22</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>代码很简单，不解释，依赖winrar的rar.exe文件。win10测试通过。\</p>
<p><code>@ECHO OFF&amp;PUSHD %~DP0 &amp;TITLE 一键备份mode con cols=70 lines=20color 2FRd &quot;%WinDir%system32test_permissions&quot; &gt;NUL 2&gt;NULMd &quot;%WinDir%System32test_permissions&quot; 2&gt;NUL||(Echo 请使用右键管理员身份运行！&amp;&amp;PAUSE &gt;NUL&amp;&amp;EXIT)Rd &quot;%WinDir%System32test_permissions&quot; 2&gt;NUL</code></p>
<p>set /a date=%date:~0,4%%date:~5,2%%date:~8,2%</p>
<p>set /a time=%time:~0,2%%time:~3,2%%time:~6,2%</p>
<p>net stop mysqla</p>
<p>rar a -r -s -ep1 -m1 mysql-%date%-%time%.rar<br>D:phpStudyMySQLdatawordpress_xl</p>
<p>rar a -r -s -ep1 -m1 htdocs-%date%-%time%.rar<br>D:YuFangWebSitewordpress.xl.comhtdocs</p>
<p>net start mysqla</p>
<p>echo 【按任意键退出】</p>
<p>pause&gt;nul exit</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://blog.leiyanhui.com/2020/08/22/typecho/onekeybackupmysqlandhtdocs.html/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="joyanhui@qq.com">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小类随手记">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/08/22/typecho/onekeybackupmysqlandhtdocs.html/" class="post-title-link" itemprop="url">批处理和rar一键热备mysql和htdocs</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2020-08-22 01:49:44 / 修改时间：10:42:20" itemprop="dateCreated datePublished" datetime="2020-08-22T01:49:44+08:00">2020-08-22</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>重新写了一个一键热备份mysql和htdocs并用rar.exe固实压缩，程序比较简单不需要管理员权限，可以和计划任务配合使用。不解释，看代码和注释。<br>如果有兴趣可以自行添加定期删除一个月之前的文件<br><br>``</p>
<p>@ECHO OFF&amp;PUSHD %~DP0 &amp;TITLE 一键备份Mysql和指定目录<br>mode con cols=100 lines=20<br>color 2F<br>echo.<br>echo.==========================================================</p>
<ol>
<li>MYSQL和文件备份批处理</li>
<li>需要修改本批处理的连接信息和目录信息<br>echo.==========================================================</li>
</ol>
<p>echo.<br>echo.<br>::=================================<br>:: 修改一下配置参数<br>::=================================<br>:: 设置备份目录<br>set backupdir=%cd%bakupfile<br>::set backupdir=%cd%<br>:: 设置临时文件名称<br>set /a date=%date:~0,4%%date:~5,2%%date:~8,2%<br>set /a time=%time:~0,2%%time:~3,2%%time:~6,2%<br>set fileTempName=%date%-%time%</p>
<p>:: MYSQL的BIN目录<br>set mysqldump=D:phpStudyMySQLbin<br>:: rar目录<br>set rardir=D:GreenSoftSystemToolsWinRAR<br>:: 用户名<br>set username=root<br>:: 密码<br>set password=root<br>:: 数据库<br>set database=wordpress_xl<br>:: 需要备份的目录<br>set backfiles=D:YuFangWebSitewordpress.xl.comhtdocs<br>::=================================<br>:: 配置修改结束<br>::=================================</p>
<p>echo.<br>echo.MYSQLDUMP路径：%mysqldump%mysqldump.exe<br>echo.<br>echo.备份文件：%backfiles%<br>echo.<br>echo.数据库：%database%<br>echo.<br>echo.备份路径：%backupdir%<br>echo.</p>
<p>echo.<br>echo.正在执行备份操作...<br>%mysqldump%mysqldump -u%username% -p%password% %database% &gt;<br>%backupdir%%database%-%fileTempName%.sql<br>echo.<br>echo.<br>:: 压缩sql文件<br>%rardir%rar.exe a -r -s -ep1 -m5<br>%backupdir%%fileTempName%-mysql-%database%.rar<br>%backupdir%%database%-%fileTempName%.sql</p>
<p>:: 删除临时sql文件<br>del /f /q %backupdir%%database%-%fileTempName%.sql</p>
<p>:: 压缩需要备份的文件夹<br>%rardir%rar.exe a -r -s -ep1 -m5 -ms<br>%backupdir%%fileTempName%-htdocs.rar %backfiles%</p>
<p>echo 【按任意键退出】<br>:: 计划任务模式请删除最后一行<br>pause&gt;nul exit\</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://blog.leiyanhui.com/2020/08/22/typecho/onekeyback-lnmp.html/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="joyanhui@qq.com">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小类随手记">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/08/22/typecho/onekeyback-lnmp.html/" class="post-title-link" itemprop="url">基于国人lnmp一键安装包的一键备份</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2020-08-22 01:49:44 / 修改时间：11:07:02" itemprop="dateCreated datePublished" datetime="2020-08-22T01:49:44+08:00">2020-08-22</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>简单修改了一下，可以一键备份mysql和wwwroot所有数据  以及nginx和php的配置<br>并且删除7天之前的备份。当然也和原版一样支持 ftp，支持计划任务</p>
<p>原版可以参考lnmp目录里面的 tools/backup.sh<br><br>先安装依赖包，计划任务和lftp<br>编辑计划任务</p>
<pre><code>yum install vixie-cron crontabs lftp
chkconfig crond on
service crond start  
crontab -e</code></pre>
<p>添加一行</p>
<pre><code>0 3   * /home/wwwroot/backup.sh</code></pre>
<p>注意北京时间和vps时差</p>
<p>下面内容存到 /home/wwwroot/backup.sh<br>然后</p>
<pre><code>chmod 555 /home/wwwroot/backup.sh</code></pre>
<p>如果放到/home/wwwroot/目录，一定注意/home/wwwroot/backup.sh的文件权限<br>和所有者。</p>
<pre><code>#!/bin/bash

#Funciont: Backup website and mysql database
#Author: licess
#Website: https://lnmp.org
#Edit by:leiyanhui.com

#IMPORTANT!!!Please Setting the following Values!

Backup_Home=&quot;/home/backup/&quot;
MySQL_Dump=&quot;/usr/local/mysql/bin/mysqldump&quot;
######~Set Directory you want to backup~######
Backup_Dir=(&quot;/home/wwwroot&quot; &quot;/usr/local/nginx/conf&quot; &quot;/usr/local/php/etc&quot;)

######~Set MySQL Database you want to backup~######
Backup_Database=(&quot;--all-databases&quot;)

######~Set MySQL UserName and password~######
MYSQL_UserName=&#39;root&#39;
MYSQL_PassWord=&#39;&#39;

######~Enable Ftp Backup~######
Enable_FTP=0
# 0: enable; 1: disable
######~Set FTP Information~######
FTP_Host=&#39;ftp.leiyanhui.com&#39;
FTP_Username=&#39;ftpusername&#39;
FTP_Password=&#39;yourftppassword&#39;
FTP_Dir=&quot;/myfolder/back-for-vps&quot;

#Values Setting END!

TodayWWWBackup=www-*-$(date +&quot;%Y%m%d&quot;).tar.gz
TodayDBBackup=db-*-$(date +&quot;%Y%m%d&quot;).sql

OldWWWBackup=www-*-$(date -d -7day +&quot;%Y%m%d&quot;).tar.gz
OldDBBackup=db-*-$(date -d -7day +&quot;%Y%m%d&quot;).sql

Backup_Dir()
(花括号)
    Backup_Path=$1
    Dir_Name=echo $(花括号)Backup_Path##*/(花括号)
    Pre_Dir=echo $(花括号)Backup_Path(花括号)|sed &#39;s/&#39;$(花括号)Dir_Name(花括号)&#39;//g&#39;
    tar zcf $(花括号)Backup_Home(花括号)www-$(花括号)Dir_Name(花括号)-$(date +&quot;%Y%m%d&quot;).tar.gz -C $(花括号)Pre_Dir(花括号) $(花括号)Dir_Name(花括号)
(花括号)
Backup_Sql()
(花括号)
    $(花括号)MySQL_Dump(花括号) -u$MYSQL_UserName -p$MYSQL_PassWord $1 &gt; $(花括号)Backup_Home(花括号)db-$1-$(date +&quot;%Y%m%d&quot;).sql
(花括号)

if [ ! -f $(花括号)MySQL_Dump(花括号) ]; then  
    echo &quot;mysqldump command not found.please check your setting.&quot;
    exit 1
fi

if [ ! -d $(花括号)Backup_Home(花括号) ]; then  
    mkdir -p $(花括号)Backup_Home(花括号)
fi

if [ $(花括号)Enable_FTP(花括号) = 0 ]; then
    type lftp &gt;/dev/null 2&gt;&amp;1 || (花括号) echo &gt;&amp;2 &quot;lftp command not found. Install: centos:yum install lftp,debian/ubuntu:apt-get install lftp.&quot;; (花括号)
fi

echo &quot;Backup website and conf files...&quot;
for dd in $(花括号)Backup_Dir[@](花括号);do
    Backup_Dir $(花括号)dd(花括号)
done

echo &quot;Backup Databases...&quot;
for db in $(花括号)Backup_Database[@](花括号);do
    Backup_Sql $(花括号)db(花括号)
done

echo &quot;Delete old backup files...&quot;
rm -f $(花括号)Backup_Home(花括号)$(花括号)OldWWWBackup(花括号)
rm -f $(花括号)Backup_Home(花括号)$(花括号)OldDBBackup(花括号)

if [ $(花括号)Enable_FTP(花括号) = 0 ]; then
    echo &quot;Uploading backup files to ftp...&quot;
    cd $(花括号)Backup_Home(花括号)
    lftp $(花括号)FTP_Host(花括号) -u $(花括号)FTP_Username(花括号),$(花括号)FTP_Password(花括号) &lt;&lt; EOF
cd $(花括号)FTP_Dir(花括号)
mrm $(花括号)OldWWWBackup(花括号)
mrm $(花括号)OldDBBackup(花括号)
mput $(花括号)TodayWWWBackup(花括号)
mput $(花括号)TodayDBBackup(花括号)
bye
EOF

echo &quot;complete.&quot;
fi</code></pre>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://blog.leiyanhui.com/2020/08/22/typecho/nodejstaobao.html/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="joyanhui@qq.com">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小类随手记">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/08/22/typecho/nodejstaobao.html/" class="post-title-link" itemprop="url">node.js更换和删除淘宝源</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2020-08-22 01:49:44 / 修改时间：10:44:10" itemprop="dateCreated datePublished" datetime="2020-08-22T01:49:44+08:00">2020-08-22</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><a href="index.html">node.js更换和删除淘宝源</a></p>
<p>设置淘宝源<br>npm config set registry <a target="_blank" rel="noopener" href="http://registry.npm.taobao.org/">http://registry.npm.taobao.org/</a><br>切换为官方<br>npm config set registry <a target="_blank" rel="noopener" href="https://registry.npmjs.org/">https://registry.npmjs.org</a><br>查询当前源<br>npm get registry</p>
<p>清理缓存 npm cache clean -f</p>
<p>附上elelctron相关的淘宝镜像地址：<a target="_blank" rel="noopener" href="https://npm.taobao.org/mirrors/electron/">https://npm.taobao.org/mirrors/electron/</a></p>
<p>npm config set disturl <a target="_blank" rel="noopener" href="https://npm.taobao.org/dist">https://npm.taobao.org/dist</a></p>
<p>cnpm config set disturl <a target="_blank" rel="noopener" href="https://npm.taobao.org/dist">https://npm.taobao.org/dist</a></p>
<p>npm config set<br>ELECTRON_MIRROR=<a target="_blank" rel="noopener" href="https://npm.taobao.org/mirrors/electron/">https://npm.taobao.org/mirrors/electron/</a><br>cnpm config set<br>ELECTRON_MIRROR=<a target="_blank" rel="noopener" href="https://npm.taobao.org/mirrors/electron/">https://npm.taobao.org/mirrors/electron/</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://blog.leiyanhui.com/2020/08/22/typecho/nodejsrequest.html/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="joyanhui@qq.com">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小类随手记">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/08/22/typecho/nodejsrequest.html/" class="post-title-link" itemprop="url">nodejs使用request模块方便判断服务器是否正常</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2020-08-22 01:49:44 / 修改时间：11:07:02" itemprop="dateCreated datePublished" datetime="2020-08-22T01:49:44+08:00">2020-08-22</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>先安装<br>npm install request --save</p>
<h1 id="服务器上放一个1bit的文件"><a href="#服务器上放一个1bit的文件" class="headerlink" title="服务器上放一个1bit的文件"></a>服务器上放一个1bit的文件</h1><p>request(serv2+serv_file1bit, function (error, response, body) (花括号)</p>
<pre><code>    if (!error &amp;&amp; response.statusCode == 200) (花括号)
      win.loadURL(serv2+webappver); //打开服务器2
    (花括号)else(花括号)
      win.loadFile(&quot;index.html&quot;); //打开错误提示页
    (花括号)
  (花括号));</code></pre>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://blog.leiyanhui.com/2020/08/22/typecho/no-vpn.html/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="joyanhui@qq.com">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小类随手记">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/08/22/typecho/no-vpn.html/" class="post-title-link" itemprop="url">几个上网的资源</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2020-08-22 01:49:44 / 修改时间：10:44:55" itemprop="dateCreated datePublished" datetime="2020-08-22T01:49:44+08:00">2020-08-22</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>整理一下kx上网要用的东西\</p>
<p>1、某宝的一个轻量级的vps或者ssr账户<a target="_blank" rel="noopener" href="http://leiyanhui.com/minivps-debian-ssr/">在vps上搭建ssr</a><br>2、ssr客户端：<br>iPhone免费客户端wingy 收费shadowrocket、surge<br>Android：&lt;pre&gt;<br><a target="_blank" rel="noopener" href="https://github.com/shadowsocks/shadowsocks-android/releases">https://github.com/shadowsocks/shadowsocks-android/releases</a><br>&lt;/pre&gt;<br>windows&lt;pre&gt;<br><a target="_blank" rel="noopener" href="https://github.com/shadowsocks/shadowsocks-windows">https://github.com/shadowsocks/shadowsocks-windows</a><br>&lt;/pre&gt;<br>macos&lt;pre&gt;<br><a target="_blank" rel="noopener" href="https://github.com/shadowsocks/ShadowsocksX-NG">https://github.com/shadowsocks/ShadowsocksX-NG</a><br>&lt;/pre&gt;</p>
<p>3、有人维护的gfwlist&lt;pre&gt;<br><a target="_blank" rel="noopener" href="https://github.com/gfwlist/gfwlist">https://github.com/gfwlist/gfwlist</a><br>&lt;/pre&gt;<br>4、自动更新hosts mac和Windows通用<br><a target="_blank" rel="noopener" href="http://leiyanhui.com/online-update-hosts/">在线hosts文件,Mac和win下通用</a></p>
<pre><code>https://github.com/oldj/SwitchHosts</code></pre>
<p>5、有人维护的hosts&lt;pre&gt;<br><a target="_blank" rel="noopener" href="https://github.com/racaljk/hosts/blob/master/hosts">https://github.com/racaljk/hosts/blob/master/hosts</a><br>&lt;/pre&gt;备用&lt;pre&gt;<br><a target="_blank" rel="noopener" href="https://coding.net/u/scaffrey/p/hosts/git">https://coding.net/u/scaffrey/p/hosts/git</a><br>&lt;/pre&gt;</p>
<p>好担心github.…</p>
<p>备份个吧</p>
<pre><code>链接: http://pan.baidu.com/s/1hsuxYVM 密码: tz9r</code></pre>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://blog.leiyanhui.com/2020/08/22/typecho/myvps.html/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="joyanhui@qq.com">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小类随手记">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/08/22/typecho/myvps.html/" class="post-title-link" itemprop="url">自用linux vps 快速恢复和搭建</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2020-08-22 01:49:44 / 修改时间：10:53:44" itemprop="dateCreated datePublished" datetime="2020-08-22T01:49:44+08:00">2020-08-22</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>1、安装bbr</p>
<pre><code>  wget --no-check-certificate https://github.com/teddysun/across/raw/master/bbr.sh
chmod +x bbr.sh</code></pre>
<p>./bbr.sh</p>
<p>2、安装ssr<br>3.1 安装chacha20的库<br>yum -y groupinstall &quot;Development Tools&quot;<br>wget <a target="_blank" rel="noopener" href="https://download.libsodium.org/libsodium/releases/LATEST.tar.gz">https://download.libsodium.org/libsodium/releases/LATEST.tar.gz</a><br>tar xf LATEST.tar.gz &amp;&amp; cd libsodium-stable<br>./configure &amp;&amp; make -j4 &amp;&amp; make install<br>echo /usr/local/lib &gt; /etc/ld.so.conf.d/usr_local_lib.conf<br>ldconfig<br>cd ~</p>
<p>3/2 wget -c<br><a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/ToyoDAdoubi/doubi/master/ssr.sh">https://raw.githubusercontent.com/ToyoDAdoubi/doubi/master/ssr.sh</a><br>chmod +x ssr.sh &amp;&amp; bash ssr.sh</p>
<p>4、添加防火墙端口</p>
<p>1、 快速安装nginx 和 php-fpm 为了避免以后麻烦还是使用lnmp一键包<br>yum -y install screen<br>screen -S lnmp<br>wget <a target="_blank" rel="noopener" href="http://soft.vpser.net/lnmp/lnmp1.6.tar.gz">http://soft.vpser.net/lnmp/lnmp1.6.tar.gz</a> -cO lnmp1.6.tar.gz &amp;&amp;<br>tar zxf lnmp1.6.tar.gz &amp;&amp; cd lnmp1.6 &amp;&amp; LNMP_Auto=&quot;y&quot; DBSelect=&quot;0&quot;<br>PHPSelect=&quot;5&quot; SelectMalloc=&quot;1&quot; ./install.sh lnmp<br>恢复备份数据</p>
<p>/usr/local/nginx/conf/vhost</p>
<p>wget -c<br><a href="ftp://ftpuser/*/@ftpuser.ftp.aliapp.com/myfolder/back-for-vps/www-wwwroot-20190929.tar.gz/">ftp://ftpuser:\*\@ftpuser.ftp.aliapp.com/myfolder/back-for-vps/www-wwwroot-20190929.tar.gz\</a><br><a href="ftp://ftpuser/*/@ftpuser.ftp.aliapp.com/myfolder/back-for-vps/www-conf-20190929.tar.gz/">ftp://ftpuser:\*\@ftpuser.ftp.aliapp.com/myfolder/back-for-vps/www-conf-20190929.tar.gz\</a><br><a href="ftp://ftpuser/*/@ftpuser.ftp.aliapp.com/myfolder/back-for-vps/www-etc-20190929.tar.gz">ftp://ftpuser:\*\@ftpuser.ftp.aliapp.com/myfolder/back-for-vps/www-etc-20190929.tar.gz</a></p>
<p>cd /home/wwwroot/<br>覆盖nginx php配置文件、设置 /home/wwwroot/ 子目录权限<br>/usr/local/nginx/conf<br>/usr/local/php/etc/</p>
<pre><code>chattr -i /home/wwwroot/*/.user.ini</code></pre>
<p>tar -xzvf www-wwwroot-<em>*</em>.tar.gz<br>chown www:www -R /home/wwwroot/*<br>chattr +i /home/wwwroot/*/.user.ini<br>chmod +x backup.sh</p>
<p>yum install lftp</p>
<p>crontab -e</p>
<pre><code>0 3 * * * /home/wwwroot/backup.sh</code></pre>
<p>59 23 * /sbin/reboot</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/4/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/4/">4</a><span class="page-number current">5</span><a class="page-number" href="/page/6/">6</a><span class="space">&hellip;</span><a class="page-number" href="/page/9/">9</a><a class="extend next" rel="next" href="/page/6/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">joyanhui@qq.com</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">87</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">joyanhui@qq.com</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
